"use strict";!function(){var LIST_NONE="<none>",_pGlob={objCache:{},fadeAnnotations:!0,pickedObject:"",hoveredObject:"",mediaElements:{},loadedFile:"",states:[],percentage:0,openedFile:"",xrSessionAcquired:!1,xrSessionCallbacks:[]};_pGlob.screenCoords=new v3d.Vector2,_pGlob.intervalTimers={},_pGlob.AXIS_X=new v3d.Vector3(1,0,0),_pGlob.AXIS_Y=new v3d.Vector3(0,1,0),_pGlob.AXIS_Z=new v3d.Vector3(0,0,1),_pGlob.MIN_DRAG_SCALE=.001,_pGlob.SET_OBJ_ROT_EPS=1e-8,_pGlob.vec2Tmp=new v3d.Vector2,_pGlob.vec2Tmp2=new v3d.Vector2,_pGlob.vec3Tmp=new v3d.Vector3,_pGlob.vec3Tmp2=new v3d.Vector3,_pGlob.vec3Tmp3=new v3d.Vector3,_pGlob.vec3Tmp4=new v3d.Vector3,_pGlob.eulerTmp=new v3d.Euler,_pGlob.eulerTmp2=new v3d.Euler,_pGlob.quatTmp=new v3d.Quaternion,_pGlob.quatTmp2=new v3d.Quaternion,_pGlob.colorTmp=new v3d.Color,_pGlob.mat4Tmp=new v3d.Matrix4,_pGlob.planeTmp=new v3d.Plane,_pGlob.raycasterTmp=new v3d.Raycaster;var PL=v3d.PL=v3d.PL||{};v3d.puzzles=PL,PL.procedures=PL.procedures||{},PL.execInitPuzzles=function(e){var n={percentage:0,output:{initOptions:{fadeAnnotations:!0,useBkgTransp:!1,preserveDrawBuf:!1,useCompAssets:!1,useFullscreen:!0,useCustomPreloader:!1,preloaderStartCb:function(){},preloaderProgressCb:function(){},preloaderEndCb:function(){}}}};return n.container=void 0!==e&&"container"in e?e.container:"",n.output.initOptions.fadeAnnotations=!0,n.output.initOptions.useBkgTransp=!0,n.output.initOptions.preserveDrawBuf=!1,n.output.initOptions.useCompAssets=!1,n.output.initOptions.useFullscreen=!0,n.output},PL.init=function(appInstance,initOptions){var app=appInstance;initOptions=initOptions||{},"fadeAnnotations"in initOptions&&(_pGlob.fadeAnnotations=initOptions.fadeAnnotations),this.procedures.BATCH=BATCH,this.procedures.CHANGE_EXAMPLES_LOOP=CHANGE_EXAMPLES_LOOP,this.procedures.HIDE_ALL=HIDE_ALL,this.procedures.CHANGE_EXAMPLE_PROCEDURE=CHANGE_EXAMPLE_PROCEDURE,this.procedures.DISABLE_RENDERING=DISABLE_RENDERING,this.procedures["do something2"]=do_something2,this.procedures.MAKE_OBJECTS=MAKE_OBJECTS,this.procedures.MAIN=MAIN,this.procedures["do something"]=do_something,this.procedures.MAKE_LIST_TEXT=MAKE_LIST_TEXT,this.procedures.MAKE_LISTS=MAKE_LISTS,this.procedures.MAKE_HELPERS=MAKE_HELPERS,this.procedures.MAKE_TEAPOT=MAKE_TEAPOT,this.procedures.MAKE_INFINITE_GRID=MAKE_INFINITE_GRID,this.procedures.MAKE_GRID_CUBE=MAKE_GRID_CUBE,this.procedures.SET_MATERIALS=SET_MATERIALS,this.procedures.MAKE_TORUS=MAKE_TORUS,this.procedures.MAKE_SPHERE=MAKE_SPHERE,this.procedures.MAKE_GRID_POLAR=MAKE_GRID_POLAR,this.procedures.MAKE_BOX=MAKE_BOX,this.procedures.MAKE_OTHER_HELPERS=MAKE_OTHER_HELPERS;var PROC={BATCH:BATCH,CHANGE_EXAMPLES_LOOP:CHANGE_EXAMPLES_LOOP,HIDE_ALL:HIDE_ALL,CHANGE_EXAMPLE_PROCEDURE:CHANGE_EXAMPLE_PROCEDURE,DISABLE_RENDERING:DISABLE_RENDERING,"do something2":do_something2,MAKE_OBJECTS:MAKE_OBJECTS,MAIN:MAIN,"do something":do_something,MAKE_LIST_TEXT:MAKE_LIST_TEXT,MAKE_LISTS:MAKE_LISTS,MAKE_HELPERS:MAKE_HELPERS,MAKE_TEAPOT:MAKE_TEAPOT,MAKE_INFINITE_GRID:MAKE_INFINITE_GRID,MAKE_GRID_CUBE:MAKE_GRID_CUBE,SET_MATERIALS:SET_MATERIALS,MAKE_TORUS:MAKE_TORUS,MAKE_SPHERE:MAKE_SPHERE,MAKE_GRID_POLAR:MAKE_GRID_POLAR,MAKE_BOX:MAKE_BOX,MAKE_OTHER_HELPERS:MAKE_OTHER_HELPERS},obj,obj_transparent,obj_to_show_transparent,LIST_objects,grid_Cube_color,COLOR_object_transparent,LIST_grids_Cube,grid_Cube_Center_color,COLOR_object_wireframe,obj_to_show,LIST_all_meshes,list_length,obj_number;function addObjectsToGroup(){return function(e,n,t){const r="Add Object(s) to Group";n&&"<none>"!=n?function(){function o(t){function o(n){for(let s=0;s<n.length;s++){let c=n[s];if(null==c||"undefined"==c)console.log("[ GLIFTEK ]: The ",r,"plugin puzzle is missing an input in list slot",s+1);else if(c instanceof v3d.Mesh==1){const e=c;o(e)}else if(c instanceof v3d.Mesh==0){const e=app.scene.getObjectByName(c);o(e)}function o(n){"add"==e?i(n):"remove"==e&&a(n)}function i(e){e.groupNames.push(t)}function a(e){for(let n=0;n<e.groupNames.length;n++)e.groupNames[n]==t?e.groupNames.pop(t):console.log("[ GLIFTEK ]: The ",r,"plugin puzzle says",t,"is not an existing group.")}}}!function(){if(Array.isArray(n)){if(Array.isArray(n)){const e=n;o(e)}}else{const e=[];e.push(n),o(e)}}()}!function(e){e[0]?"GROUP"==e[0]?o(e=e[1]):"GROUP"!==e[0]&&o(e):o(e)}(t)}():console.log("[ GLIFTEK ]: The ",r,"plugin puzzle is missing an input!")}.apply(null,arguments)}function notIgnoredObj(e){return!("AmbientLight"===e.type||""===e.name||e.isMesh&&e.isMaterialGeneratedMesh||e.isAuxClippingMesh)}function getObjectByName(e){var n,t=void 0!==_pGlob;return(n=t?_pGlob.objCache[e]:null)&&n.name===e?n:(appInstance.scene.traverse(function(r){!n&&notIgnoredObj(r)&&r.name==e&&(n=r,t&&(_pGlob.objCache[e]=n))}),n)}function getAllObjectNames(){var e=[];return appInstance.scene.traverse(function(n){notIgnoredObj(n)&&e.push(n.name)}),e}function getObjectNamesByGroupName(e){var n=[];return appInstance.scene.traverse(function(t){if(notIgnoredObj(t)){var r=t.groupNames;if(!r)return;for(var o=0;o<r.length;o++){r[o]==e&&n.push(t.name)}}}),n}function retrieveObjectNames(e){var n=[];return retrieveObjectNamesAcc(e,n),n.filter(function(e){return e})}function retrieveObjectNamesAcc(e,n){if("string"==typeof e)n.push(e);else if(Array.isArray(e)&&"GROUP"==e[0])for(var t=getObjectNamesByGroupName(e[1]),r=0;r<t.length;r++)n.push(t[r]);else if(Array.isArray(e)&&"ALL_OBJECTS"==e[0])for(t=getAllObjectNames(),r=0;r<t.length;r++)n.push(t[r]);else if(Array.isArray(e))for(r=0;r<e.length;r++)retrieveObjectNamesAcc(e[r],n)}function batchGeometry(e){for(var n=retrieveObjectNames(e),t=[],r=0;r<n.length;r++){var o=n[r];if(o){var i=getObjectByName(o);i&&i.resolveMultiMaterial().forEach(function(e){e.isMesh&&e.geometry&&t.push(e)})}}t.length>=2&&v3d.BufferGeometryUtils.batchMeshes(t,appInstance.scene)}function BATCH(){addObjectsToGroup("add",["Box","Box_transparent"],"GROUP_Box"),batchGeometry(["GROUP","GROUP_Box"]),addObjectsToGroup("add",["Torus","Torus_transparent"],"GROUP_Torus"),batchGeometry(["GROUP","GROUP_Torus"]),addObjectsToGroup("add",["Teapot","Teapot_transparent"],"GROUP_Teapot"),batchGeometry(["GROUP","GROUP_Teapot"])}function initObjectPicking(e,n,t,r){var o=appInstance.renderer.domElement;if(o.addEventListener(n,l),v3d.PL.editorEventListeners&&v3d.PL.editorEventListeners.push([o,n,l]),"mousedown"==n){var i=t?"touchstart":"touchend";o.addEventListener(i,l),v3d.PL.editorEventListeners&&v3d.PL.editorEventListeners.push([o,i,l])}else if("dblclick"==n){var a=0;function s(e){var n=(new Date).getTime()-a;if(n<600&&n>0)return l(e),void(a=0);a=(new Date).getTime()}i=t?"touchstart":"touchend";o.addEventListener(i,s),v3d.PL.editorEventListeners&&v3d.PL.editorEventListeners.push([o,i,s])}var c=new v3d.Raycaster;function l(n){if(appInstance.getCamera()){n.preventDefault();var t=0,i=0;if(n instanceof MouseEvent){if(r&&-1==r.indexOf(n.button))return;t=n.offsetX/o.clientWidth,i=n.offsetY/o.clientHeight}else if(n instanceof TouchEvent){var a=o.getBoundingClientRect();t=(n.changedTouches[0].clientX-a.left)/a.width,i=(n.changedTouches[0].clientY-a.top)/a.height}_pGlob.screenCoords.x=2*t-1,_pGlob.screenCoords.y=2*-i+1,c.setFromCamera(_pGlob.screenCoords,appInstance.getCamera(!0));var s=[];appInstance.scene.traverse(function(e){s.push(e)});var l=c.intersectObjects(s);e(l,n)}}}function objectsIncludeObj(e,n){if(!n)return!1;for(var t=0;t<e.length;t++){if(n==e[t])return!0;var r=getObjectByName(e[t]);if(r&&"Group"==r.type)for(var o=0;o<r.children.length;o++)if(n==r.children[o].name)return!0}return!1}function getPickedObjectName(e){return e.isMesh&&e.isMaterialGeneratedMesh&&e.parent?e.parent.name:e.name}function registerOnClick(e,n,t,r,o,i){_pGlob.objClickInfo=_pGlob.objClickInfo||[],_pGlob.objClickInfo.push({objSelector:e,callbacks:[o,i]}),initObjectPicking(function(t,r){for(var a=!1,s=n?t.length:Math.min(1,t.length),c=0;c<s;c++){var l=getPickedObjectName(t[c].object);objectsIncludeObj(retrieveObjectNames(e),l)&&(_pGlob.pickedObject=l,a=!0,o(r))}a||(_pGlob.pickedObject="",i(r))},t?"dblclick":"mousedown",!1,r)}function CHANGE_EXAMPLES_LOOP(){registerOnClick(LIST_objects,!1,!1,[0,1,2],function(){CHANGE_EXAMPLE_PROCEDURE(_pGlob.pickedObject)},function(){})}function disableRendering(e){appInstance.ssaaOnPause=e,appInstance.disableRendering(1)}function changeVis(e,n){for(var t=retrieveObjectNames(e),r=0;r<t.length;r++){var o=t[r];if(o){var i=getObjectByName(o);i&&(i.visible=n)}}}function HIDE_ALL(){disableRendering(!0),changeVis("Teapot",!0),changeVis("Teapot_transparent",!0),changeVis("polarGridHelper_1",!0),changeVis("infiniteGridHelper_1",!0),changeVis(LIST_grids_Cube,!0)}function CHANGE_EXAMPLE_PROCEDURE(e){obj_transparent=String(e)+"_transparent",changeVis(e,!1),changeVis(obj_transparent,!1),list_length=LIST_objects.length-1,(obj_number=LIST_objects.indexOf(e))<list_length?(obj_to_show=LIST_objects[obj_number+1],do_something()):obj_number>=list_length&&(obj_to_show=LIST_objects[0],do_something())}function enableRendering(){appInstance.enableRendering()}function getElements(e,n){var t=[];if(Array.isArray(e)&&"CONTAINER"!=e[0]&&"WINDOW"!=e[0]&&"DOCUMENT"!=e[0]&&"BODY"!=e[0]&&"QUERYSELECTOR"!=e[0])for(var r=0;r<e.length;r++)t.push(getElement(e[r],n));else t.push(getElement(e,n));return t}function getElement(e,n){var t;if(Array.isArray(e)&&"CONTAINER"==e[0]){if(null!==appInstance)t=appInstance.container;else if("undefined"!=typeof _initGlob){e=_initGlob.container;t=n?parent.document.getElementById(e):document.getElementById(e)}}else t=Array.isArray(e)&&"WINDOW"==e[0]?n?parent:window:Array.isArray(e)&&"DOCUMENT"==e[0]?n?parent.document:document:Array.isArray(e)&&"BODY"==e[0]?n?parent.document.body:document.body:Array.isArray(e)&&"QUERYSELECTOR"==e[0]?n?parent.document.querySelector(e):document.querySelector(e):n?parent.document.getElementById(e):document.getElementById(e);return t}function eventHTMLElem(e,n,t,r){for(var o=getElements(n,t),i=0;i<o.length;i++){var a=o[i];a&&(a.addEventListener(e,r),v3d.PL.editorEventListeners&&v3d.PL.editorEventListeners.push([a,e,r]))}}function DISABLE_RENDERING(){eventHTMLElem("pointerdown",["CONTAINER"],!1,function(e){enableRendering()}),eventHTMLElem("pointerup",["CONTAINER"],!1,function(e){disableRendering(!0)})}function screenFade(){return function(screenFade_ID_Input,screenFade_Z_Index_Input,typeDropdown,screenFade_Pause_Input,screenFade_Duration_Input,colorInput_1_PICKER,colorInput_1_TEXT,delete_When_Done_Checkbox,whenDone_Statement_Input){const puzzleName="Print To Modal Card";function mainFunction(){function setColorFromInputs(e,n){let t;return void 0===e||null==typeof e||""==e?(t=n,console.log(n,"supplied. using PICKER.")):(t=e,console.log(e,"supplied. using TEXT.")),t}const colorInput_1esc=setColorFromInputs(colorInput_1_TEXT,colorInput_1_PICKER);console.log("colorInput_1esc:",colorInput_1esc);let computedColorDiv=document.createElement("div");function RGBA_from_color_input(e,n){if("transparent"==e||null==e||void 0===e)return"rgba(0, 0, 0, 0)";{computedColorDiv.style.color=e;let t=window.getComputedStyle(computedColorDiv).color;console.log("computedColor for: ",e,":",t);let r=t.length,o="rgba("+t.substring(4,r-1)+", "+n+")";return console.log("computedColor_RGBA for: ",e,":",o),o}}computedColorDiv.id="computedColorDiv-"+screenFade_ID_Input,document.body.appendChild(computedColorDiv);const screenFadeColor=RGBA_from_color_input(colorInput_1esc,1);console.log("screenFadeColor: ",screenFadeColor),computedColorDiv.remove();let styleVar=setstyleVar(),style=document.createElement("style");style.id="screenFade-"+screenFade_ID_Input,style.innerHTML=styleVar,document.head.appendChild(style);let screenFade_Div=document.createElement("div");function getBGcolor(){"in"==typeDropdown?(screenFade_Div.style.backgroundColor="rgba(0,0,0,0)",console.log("screenFade_Div.style.backgroundColor:",screenFade_Div.style.backgroundColor)):"out"==typeDropdown&&(screenFade_Div.style.backgroundColor=screenFadeColor,console.log("screenFade_Div.style.backgroundColor:",screenFade_Div.style.backgroundColor))}screenFade_Div.id=screenFade_ID_Input,screenFade_Div.className="screenFade-"+screenFade_ID_Input,getBGcolor();const container=document.getElementById("v3d-container");function animateScreenFade(){const animationType="animation-screen-fade-"+typeDropdown+"-"+screenFade_ID_Input;function screenFadeDisplay(){"in"==typeDropdown?(screenFade_Div.style.display="block",console.log("screenFade_Div.style.display:",screenFade_Div.style.display),deleteWhenDone()):"out"==typeDropdown&&(screenFade_Div.style.display="none",console.log("screenFade_Div.style.display:",screenFade_Div.style.display),deleteWhenDone())}function deleteWhenDone(){1==delete_When_Done_Checkbox&&screenFade_Div.remove()}screenFade_Div.style.animationName=animationType,console.log("screenFade_Div.style.animationName:",screenFade_Div.style.animationName),screenFade_Div.addEventListener("animationend",function(event){event.animationName;{screenFade_Div.removeEventListener("animationend",null),screenFadeDisplay();let screenFadeState=eval(`${screenFade_ID_Input}.faded = '${typeDropdown}';`);console.log("screenFadeState:",screenFadeState),whenDone_Statement_Input()}})}function setstyleVar(){return`\n                #computedColorDiv-${screenFade_ID_Input}\n                {\n                    height: 0px;\n                    width: 0px;\n                    display: none;\n                    z-index = -10;\n                }\n\n                .screenFade-${screenFade_ID_Input}\n                {\n                    display: block;\n                    position: fixed;\n                    z-index: ${screenFade_Z_Index_Input};\n                    left: 0;\n                    top: 0;\n                    height: 100%;\n                    width: 100%;\n                    overflow: hidden;\n                    pointer-events: none;\n\n                    animation-duration: ${screenFade_Duration_Input}s;\n                    animation-timing-function: ease-in-out;\n                }\n\n\n                @keyframes animation-screen-fade-in-${screenFade_ID_Input}\n                {\n                    from {\n                        background-color: rgba(0,0,0,0);\n                    }\n                    to {\n                        background-color: ${screenFadeColor};\n                    }\n                }\n\n\n                @keyframes animation-screen-fade-out-${screenFade_ID_Input}\n                {\n                    from {\n                        background-color: ${screenFadeColor};\n                    }\n                    to {\n                        background-color: rgba(0,0,0,0);\n                    }\n                }\n\n                `}container.appendChild(screenFade_Div),setTimeout(function(){animateScreenFade()},1e3*screenFade_Pause_Input)}eval(`window.${screenFade_ID_Input} = { faded: null };`),screenFade_ID_Input?mainFunction():console.log("[ GLIFTEK ]: The",puzzleName,"plugin puzzle is missing an input!")}.apply(null,arguments)}function do_something2(){screenFade("screenFade_1",10,"out",1.5,1,"#000000","",!0,function(){disableRendering(!0)})}function registerSetTimeout(e,n){window.setTimeout(n,1e3*e)}function MAKE_OBJECTS(){MAKE_TEAPOT(),MAKE_TORUS(),MAKE_BOX(),registerSetTimeout(.1,function(){SET_MATERIALS(),HIDE_ALL(),CHANGE_EXAMPLES_LOOP()})}function setScreenScale(e){appInstance.useHiDPIRenderPass||appInstance.renderer.setPixelRatio(e),appInstance.postprocessing&&appInstance.postprocessing.composer.setPixelRatio(e),appInstance.onResize()}function MAIN(){do_something2(),setScreenScale(1.5),MAKE_LIST_TEXT(),MAKE_HELPERS(),MAKE_OBJECTS(),DISABLE_RENDERING()}function do_something(){obj_to_show_transparent=String(obj_to_show)+"_transparent",changeVis(obj_to_show,!0)}function MAKE_LIST_TEXT(){LIST_objects=["Teapot","Torus","Box"],LIST_all_meshes=["Teapot","Torus","Box","Teapot_transparent","Torus_transparent","Box_transparent"],LIST_grids_Cube=["gridHelper_1","gridHelper_2","gridHelper_3"]}function MAKE_LISTS(){LIST_objects=["Teapot","Torus","Sphere"],LIST_grids_Cube=["gridHelper_1","gridHelper_2","gridHelper_3"]}function MAKE_HELPERS(){MAKE_INFINITE_GRID(),MAKE_GRID_CUBE(),MAKE_GRID_POLAR(),MAKE_OTHER_HELPERS()}function createObject(e,n,t,r,o,i,a,s,c,l,u){var d,p,_=appInstance.scene.getObjectByName(n);switch(_&&_.parent.remove(_),e){case"BOX":p=new v3d.BoxGeometry(t,r,o);break;case"CAMERA":var E=appInstance.container.offsetWidth/appInstance.container.offsetHeight;if("PERSPECTIVE"==c)d=new v3d.PerspectiveCamera(u,E,1,1e3);else{t=u*E;d=new v3d.OrthographicCamera(-t/2,t/2,u/2,-u/2,-1e3,1e3)}d.lookAt(_pGlob.vec3Tmp.set(0,0,0));break;case"CIRCLE":p=new v3d.CircleGeometry(i,s);break;case"CONE":p=new v3d.ConeGeometry(i,r,s);break;case"CYLINDER":p=new v3d.CylinderGeometry(i,i,r,s);break;case"EMPTY":d=new v3d.Object3D;break;case"LIGHT":var f=16777215;switch(l){case"AMBIENT":d=new v3d.AmbientLight(f,.5);break;case"AREA":v3d.RectAreaLightUniformsLib.init(LTC_MAT_1,LTC_MAT_2),d=new v3d.RectAreaLight(f,.5,1,1);break;case"DIRECTIONAL":d=new v3d.DirectionalLight(f,.5);break;case"HEMISPHERE":d=new v3d.HemisphereLight(f,0,.5);break;case"POINT":d=new v3d.PointLight(f,.5);break;case"SPOT":d=new v3d.SpotLight(f,.5)}d.isFreeLight=!0;break;case"PLANE":p=new v3d.PlaneGeometry(t,r,1,1);break;case"SPHERE":p=new v3d.SphereGeometry(i,32,32);break;case"TEAPOT":p=new v3d.TeapotGeometry(t);break;case"TORUS":p=new v3d.TorusGeometry(i,a,32,32)}if(p){var m=new v3d.MeshStandardMaterial({color:"white",roughness:1,metalness:0,side:"CIRCLE"==e||"PLANE"==e||"TEAPOT"==e?v3d.DoubleSide:v3d.FrontSide});m.name=n+"Material",d=new v3d.Mesh(p,m)}d.name=n,appInstance.scene.add(d),_pGlob.objCache={}}function makeParent(e,n){if(e){var t=getObjectByName(e);if(t){if(n&&n!==LIST_NONE){var r=getObjectByName(n);if(!r)return}else t.traverseAncestors(function(e){"Scene"==e.type&&(r=e)});var o=new v3d.Matrix4;o.copy(r.matrixWorld).invert(),o.multiply(t.matrixWorld),o.decompose(t.position,t.quaternion,t.scale),r.add(t),t.updateMatrixWorld(!0)}}}function getCoordSystem(){var e=appInstance.scene;return e&&"v3d"in e.userData&&"coordSystem"in e.userData.v3d?e.userData.v3d.coordSystem:"Z_UP_RIGHT"}function coordsTransform(e,n,t,r){if(n==t)return e;var o=e.y,i=e.z;return"Z_UP_RIGHT"==n&&"Y_UP_RIGHT"==t?(e.y=i,e.z=r?o:-o):"Y_UP_RIGHT"==n&&"Z_UP_RIGHT"==t?(e.y=r?i:-i,e.z=o):console.error("coordsTransform: Unsupported coordinate space"),e}var eulerV3DToBlenderShortest=(eulerTmp=new v3d.Euler,eulerTmp2=new v3d.Euler,vec3Tmp=new v3d.Vector3,function(e,n){var t=eulerTmp.copy(e).reorder("YZX"),r=eulerTmp2.copy(t).makeAlternative(),o=t.toVector3(vec3Tmp).lengthSq(),i=r.toVector3(vec3Tmp).lengthSq();return n.copy(o<i?t:r),coordsTransform(n,"Y_UP_RIGHT","Z_UP_RIGHT")}),eulerTmp,eulerTmp2,vec3Tmp;function RotationInterface(){this._userRotation=new v3d.Euler(0,0,0,"ZYX"),this._actualRotation=new v3d.Euler}function setObjTransform(e,n,t,r){var o=t[0],i=t[1],a=t[2],s=retrieveObjectNames(e);function c(e,t,o){r?"scale"!=n?e[n][t]+=o:e[n][t]*=o:e[n][t]=o}var l=_pGlob.vec3Tmp.set(Number(""!==o),Number(""!==i),Number(""!==a)),u=_pGlob.vec3Tmp2.set(o||0,i||0,a||0);"rotation"===n&&u.multiplyScalar(v3d.MathUtils.DEG2RAD);var d=getCoordSystem();coordsTransform(l,d,"Y_UP_RIGHT",!0),coordsTransform(u,d,"Y_UP_RIGHT","scale"===n);for(var p=0;p<s.length;p++){var _=s[p];if(_){var E=getObjectByName(_);if(E){if("rotation"===n&&"Z_UP_RIGHT"==d)coordsTransform(m=eulerV3DToBlenderShortest(E.rotation,_pGlob.eulerTmp),d,"Y_UP_RIGHT"),l.x&&(m.x=r?m.x+u.x:u.x),l.y&&(m.y=r?m.y+u.y:u.y),l.z&&(m.z=r?m.z+u.z:u.z),m.order="YZX",m.reorder(E.rotation.order),E.rotation.copy(m);else if("rotation"===n&&"Y_UP_RIGHT"==d){var f=RotationInterface.initObject(E),m=f.getUserRotation(_pGlob.eulerTmp);l.x&&(m.x=r?m.x+u.x:u.x),l.y&&(m.y=r?m.y+u.y:u.y),l.z&&(m.z=r?m.z+u.z:u.z),f.setUserRotation(m),f.getActualRotation(E.rotation)}else l.x&&c(E,"x",u.x),l.y&&c(E,"y",u.y),l.z&&c(E,"z",u.z);E.updateMatrixWorld(!0)}}}}function MAKE_TEAPOT(){createObject("TEAPOT","Teapot",2,0,0,0,0,0,"PERSPECTIVE","AMBIENT",0),createObject("TEAPOT","Teapot_transparent",2,0,0,0,0,0,"PERSPECTIVE","AMBIENT",0),makeParent("Teapot_transparent","Teapot"),setObjTransform("Teapot","position",["","",5],!1),setObjTransform("Teapot","rotation",["","",90],!1),changeVis("Teapot_transparent",!1)}function createInfiniteGridHelper(){return function(e,n,t,r){!function(){"undefined"==typeof infiniteGridHelperNumber?window.infiniteGridHelperNumber=1:infiniteGridHelperNumber++;if(THREE.InfiniteGridHelper=function(e,n,t,r,o="xzy"){t=t||new THREE.Color("white"),e=e||10,n=n||100,r=r||8e3;const i=o.substr(0,2),a=new THREE.PlaneBufferGeometry(2,2,1,1),s=new THREE.ShaderMaterial({side:THREE.DoubleSide,uniforms:{uSize1:{value:e},uSize2:{value:n},uColor:{value:t},uDistance:{value:r}},transparent:!0,vertexShader:`\n\n            varying vec3 worldPosition;\n\n            uniform float uDistance;\n\n            void main() {\n\n                    vec3 pos = position.${o} * uDistance;\n                    pos.${i} += cameraPosition.${i};\n\n                    worldPosition = pos;\n\n                    gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n\n            }\n            `,fragmentShader:`\n\n            varying vec3 worldPosition;\n\n            uniform float uSize1;\n            uniform float uSize2;\n            uniform vec3 uColor;\n            uniform float uDistance;\n\n\n\n                float getGrid(float size) {\n\n                    vec2 r = worldPosition.${i} / size;\n\n\n                    vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);\n                    float line = min(grid.x, grid.y);\n\n\n                    return 1.0 - min(line, 1.0);\n                }\n\n            void main() {\n\n\n                    float d = 1.0 - min(distance(cameraPosition.${i}, worldPosition.${i}) / uDistance, 1.0);\n\n                    float g1 = getGrid(uSize1);\n                    float g2 = getGrid(uSize2);\n\n\n                    gl_FragColor = vec4(uColor.rgb, mix(g2, g1, g1) * pow(d, 3.0));\n                    gl_FragColor.a = mix(0.5 * gl_FragColor.a, gl_FragColor.a, g2);\n\n                    if ( gl_FragColor.a <= 0.0 ) discard;\n\n\n            }\n\n            `,extensions:{derivatives:!0}});THREE.Mesh.call(this,a,s),this.frustumCulled=!1},THREE.InfiniteGridHelper.prototype={...THREE.Mesh.prototype,...THREE.Object3D.prototype,...THREE.EventDispatcher.prototype},parseInt(THREE.REVISION)>126){class e extends THREE.Mesh{constructor(e,n,t,r,o="xzy"){t=t||new THREE.Color("white"),e=e||10,n=n||100,r=r||8e3;const i=o.substr(0,2),a=new THREE.PlaneBufferGeometry(2,2,1,1),s=new THREE.ShaderMaterial({side:THREE.DoubleSide,uniforms:{uSize1:{value:e},uSize2:{value:n},uColor:{value:t},uDistance:{value:r}},transparent:!0,vertexShader:`\n\n            varying vec3 worldPosition;\n\n            uniform float uDistance;\n\n            void main() {\n\n                    vec3 pos = position.${o} * uDistance;\n                    pos.${i} += cameraPosition.${i};\n\n                    worldPosition = pos;\n\n                    gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n\n            }\n            `,fragmentShader:`\n\n            varying vec3 worldPosition;\n\n            uniform float uSize1;\n            uniform float uSize2;\n            uniform vec3 uColor;\n            uniform float uDistance;\n\n\n\n                float getGrid(float size) {\n\n                    vec2 r = worldPosition.${i} / size;\n\n\n                    vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);\n                    float line = min(grid.x, grid.y);\n\n\n                    return 1.0 - min(line, 1.0);\n                }\n\n            void main() {\n\n\n                    float d = 1.0 - min(distance(cameraPosition.${i}, worldPosition.${i}) / uDistance, 1.0);\n\n                    float g1 = getGrid(uSize1);\n                    float g2 = getGrid(uSize2);\n\n\n                    gl_FragColor = vec4(uColor.rgb, mix(g2, g1, g1) * pow(d, 3.0));\n                    gl_FragColor.a = mix(0.5 * gl_FragColor.a, gl_FragColor.a, g2);\n\n                    if ( gl_FragColor.a <= 0.0 ) discard;\n\n\n            }\n\n            `,extensions:{derivatives:!0}});super(a,s),this.frustumCulled=!1}}Object.assign(e.prototype,THREE.InfiniteGridHelper.prototype),THREE.InfiniteGridHelper=e}let o=new THREE.Color(r);!function(){const r=new THREE.InfiniteGridHelper(e,n,o,t);r.name="infiniteGridHelper_"+infiniteGridHelperNumber,app.scene.add(r),console.log("infiniteGridHelper:",r)}()}()}.apply(null,arguments)}function MAKE_INFINITE_GRID(){createInfiniteGridHelper(5,50,3e3,"purple")}function createGridHelper(){return function(e,n,t,r){!function(){"undefined"==typeof gridHelperNumber?window.gridHelperNumber=1:gridHelperNumber++;let o=new v3d.GridHelper(e,n,r,t);o.raycast=function(){},o.up.set(0,0,1),o.name="gridHelper_"+gridHelperNumber,app.scene.add(o)}()}.apply(null,arguments)}function MAKE_GRID_CUBE(){createGridHelper(10,10,grid_Cube_color="magenta",grid_Cube_Center_color="pink"),setObjTransform("gridHelper_1","rotation",["",90,""],!1),setObjTransform("gridHelper_1","position",[-5,"",5],!1),createGridHelper(10,10,grid_Cube_color,grid_Cube_Center_color),setObjTransform("gridHelper_2","rotation",["",-90,-90],!1),setObjTransform("gridHelper_2","position",["",5,5],!1),createGridHelper(10,10,grid_Cube_color,grid_Cube_Center_color),setObjTransform("Cube","position",["","",1],!1)}function quadWireframe(){return function(e,n,t,r,o,i,a){let s;return e&&n&&a&&t&&r&&i&&a?function(){let c={segU:{value:t},segV:{value:r},isWire:{value:o},wireWidthFactor:{value:i},wireColor:{value:new THREE.Color(a)}},l=new THREE.MeshStandardMaterial({side:THREE.DoubleSide,onBeforeCompile:e=>{e.uniforms.segU=c.segU,e.uniforms.segV=c.segV,e.uniforms.wireColor=c.wireColor,e.uniforms.isWire=c.isWire,e.uniforms.wireWidthFactor=c.wireWidthFactor,e.fragmentShader=`\n\n                uniform float segU;\n                uniform float segV;\n                uniform vec3 wireColor;\n                uniform float isWire;\n                uniform float wireWidthFactor;\n\n                ${e.fragmentShader}\n                `.replace("#include <dithering_fragment>","#include <dithering_fragment>\n\n                    // http://madebyevan.com/shaders/grid/\n                    vec2 coord = vUv * vec2(segU, segV);\n\n                    vec2 grid = abs(fract(coord - 0.5) - 0.5) / fwidth(coord);\n                    float line = min(grid.x, grid.y) / wireWidthFactor;\n                    line = 1.0 - min(line, 1.0);\n\n                    if (isWire > 0.5 && line < 0.5) discard;\n                    if (isWire > 0.5) gl_FragColor = vec4(0);\n                    gl_FragColor = mix(gl_FragColor, vec4(wireColor, 1.0), line);\n                ")}});l.color=new THREE.Color(n),l.defines={USE_UV:""},l.opacity=0,(s=app.scene.getObjectByName(e)).material=l,window.quadMaterialWin=l}():console.log("Quad Material Puzzle missing input!"),s}.apply(null,arguments)}function SET_MATERIALS(){COLOR_object_transparent="black",quadWireframe("Teapot","black",4,4,!1,3,COLOR_object_wireframe="cyan"),quadWireframe("Torus","black",8,8,!1,3,COLOR_object_wireframe),quadWireframe("Box","black",4,4,!1,3,COLOR_object_wireframe)}function MAKE_TORUS(){createObject("TORUS","Torus",0,0,0,2,1,0,"PERSPECTIVE","AMBIENT",0),createObject("TORUS","Torus_transparent",0,0,0,2,1,0,"PERSPECTIVE","AMBIENT",0),changeVis("Torus",!1),changeVis("Torus_transparent",!1),makeParent("Torus_transparent","Torus"),setObjTransform("Torus","position",["","",5],!1),setObjTransform("Torus","rotation",[90,"",""],!1)}function MAKE_SPHERE(){createObject("SPHERE","Sphere",0,0,0,2,0,0,"PERSPECTIVE","AMBIENT",0),setObjTransform("Sphere","position",["","",5],!1),changeVis("axesHelper_1",!1)}function createPolarGridHelper(){return function(e,n,t,r,o,i){!function(){"undefined"==typeof polarGridHelperNumber?window.polarGridHelperNumber=1:polarGridHelperNumber++;let a=new v3d.PolarGridHelper(e,n,t,r,o,i);a.raycast=function(){},a.name="polarGridHelper_"+polarGridHelperNumber,a.up.set(0,0,1),app.scene.add(a)}()}.apply(null,arguments)}function MAKE_GRID_POLAR(){createPolarGridHelper(5,8,6,64,"pink","pink")}function MAKE_BOX(){createObject("BOX","Box",4,4,4,0,0,0,"PERSPECTIVE","AMBIENT",0),createObject("BOX","Box_transparent",4,4,4,0,0,0,"PERSPECTIVE","AMBIENT",0),changeVis("Box",!1),changeVis("Box_transparent",!1),makeParent("Box_transparent","Box"),setObjTransform("Box","position",["","",5],!1)}function createVector(e,n,t){return[e,n,t]}function createArrowHelper(){return function(e,n,t,r,o,i){!function(){"undefined"==typeof arrowHelperNumber?window.arrowHelperNumber=1:arrowHelperNumber++;const o=new THREE.Vector3(e[0],e[1],e[2]);o.normalize();const i=new THREE.Vector3(n[0],n[1],n[2]);let a=new v3d.ArrowHelper(o,i,t,r);a.up.set(0,0,1),a.name="arrowHelper_"+arrowHelperNumber,app.scene.add(a)}()}.apply(null,arguments)}function createAxesHelper(){return function(e){!function(){"undefined"==typeof axesHelperNumber?window.axesHelperNumber=1:axesHelperNumber++;let n=new v3d.AxesHelper(e);n.raycast=function(){},n.up.set(0,0,1),n.name="axesHelper_"+axesHelperNumber,app.scene.add(n)}()}.apply(null,arguments)}function MAKE_OTHER_HELPERS(){createArrowHelper(createVector(0,-3,0),createVector(0,0,0),3,"#4682B4",.5,.25),createAxesHelper(3)}Object.assign(RotationInterface,{initObject:function(e){void 0===e.userData.v3d.puzzles&&(e.userData.v3d.puzzles={}),void 0===e.userData.v3d.puzzles.rotationInterface&&(e.userData.v3d.puzzles.rotationInterface=new RotationInterface);var n=e.userData.v3d.puzzles.rotationInterface;return n.updateFromObject(e),n}}),Object.assign(RotationInterface.prototype,{updateFromObject:function(e){this._actualRotation.equalsEps(e.rotation,1e-8)||(this._actualRotation.copy(e.rotation),this._updateUserRotFromActualRot())},getActualRotation:function(e){return e.copy(this._actualRotation)},setUserRotation:function(e){this._userRotation.set(e.x,e.y,e.z),this._updateActualRotFromUserRot()},getUserRotation:function(e){return e.copy(this._userRotation)},_updateUserRotFromActualRot:function(){var e=this._userRotation.order;this._userRotation.copy(this._actualRotation).reorder(e)},_updateActualRotFromUserRot:function(){var e=this._actualRotation.order;this._actualRotation.copy(this._userRotation).reorder(e)}}),MAIN()}}();