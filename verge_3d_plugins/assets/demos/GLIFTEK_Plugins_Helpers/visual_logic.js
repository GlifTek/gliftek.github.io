'use strict';(function(){var LIST_NONE="<none>",_pGlob={};_pGlob.objCache={},_pGlob.fadeAnnotations=!0,_pGlob.pickedObject="",_pGlob.hoveredObject="",_pGlob.mediaElements={},_pGlob.loadedFile="",_pGlob.states=[],_pGlob.percentage=0,_pGlob.openedFile="",_pGlob.xrSessionAcquired=!1,_pGlob.xrSessionCallbacks=[],_pGlob.screenCoords=new v3d.Vector2,_pGlob.intervalTimers={},_pGlob.AXIS_X=new v3d.Vector3(1,0,0),_pGlob.AXIS_Y=new v3d.Vector3(0,1,0),_pGlob.AXIS_Z=new v3d.Vector3(0,0,1),_pGlob.MIN_DRAG_SCALE=.001,_pGlob.SET_OBJ_ROT_EPS=1e-8,_pGlob.vec2Tmp=new v3d.Vector2,_pGlob.vec2Tmp2=new v3d.Vector2,_pGlob.vec3Tmp=new v3d.Vector3,_pGlob.vec3Tmp2=new v3d.Vector3,_pGlob.vec3Tmp3=new v3d.Vector3,_pGlob.vec3Tmp4=new v3d.Vector3,_pGlob.eulerTmp=new v3d.Euler,_pGlob.eulerTmp2=new v3d.Euler,_pGlob.quatTmp=new v3d.Quaternion,_pGlob.quatTmp2=new v3d.Quaternion,_pGlob.colorTmp=new v3d.Color,_pGlob.mat4Tmp=new v3d.Matrix4,_pGlob.planeTmp=new v3d.Plane,_pGlob.raycasterTmp=new v3d.Raycaster;var PL=v3d.PL=v3d.PL||{};v3d.puzzles=PL,PL.procedures=PL.procedures||{},PL.execInitPuzzles=function(e){var r={};r.percentage=0,r.output={initOptions:{fadeAnnotations:!0,useBkgTransp:!1,preserveDrawBuf:!1,useCompAssets:!1,useFullscreen:!0,useCustomPreloader:!1,preloaderStartCb:function(){},preloaderProgressCb:function(){},preloaderEndCb:function(){}}},r.container=void 0!==e&&"container"in e?e.container:"";return r.output.initOptions.fadeAnnotations=!0,r.output.initOptions.useBkgTransp=!0,r.output.initOptions.preserveDrawBuf=!1,r.output.initOptions.useCompAssets=!1,r.output.initOptions.useFullscreen=!0,r.output},PL.init=function(appInstance,initOptions){function getElements(e,r){var t=[];if(Array.isArray(e)&&"CONTAINER"!=e[0]&&"WINDOW"!=e[0]&&"DOCUMENT"!=e[0]&&"BODY"!=e[0]&&"QUERYSELECTOR"!=e[0])for(var o=0;o<e.length;o++)t.push(getElement(e[o],r));else t.push(getElement(e,r));return t}function getElement(e,r){var t;if(!(Array.isArray(e)&&"CONTAINER"==e[0]))t=Array.isArray(e)&&"WINDOW"==e[0]?r?parent:window:Array.isArray(e)&&"DOCUMENT"==e[0]?r?parent.document:document:Array.isArray(e)&&"BODY"==e[0]?r?parent.document.body:document.body:Array.isArray(e)&&"QUERYSELECTOR"==e[0]?r?parent.document.querySelector(e):document.querySelector(e):r?parent.document.getElementById(e):document.getElementById(e);else if(null!==appInstance)t=appInstance.container;else if("undefined"!=typeof _initGlob){var e=_initGlob.container;t=r?parent.document.getElementById(e):document.getElementById(e)}return t}function setHTMLElemStyle(e,r,t,o){for(var n,a=getElements(t,o),s=0;s<a.length;s++)n=a[s],n&&n.style&&(n.style[e]=r)}function notIgnoredObj(e){return"AmbientLight"!==e.type&&""!==e.name&&!(e.isMesh&&e.isMaterialGeneratedMesh)&&!e.isAuxClippingMesh}function getObjectByName(e){var r,t=void 0!==_pGlob;return(r=_pGlob.objCache[e],r&&r.name===e)?r:(appInstance.scene.traverse(function(o){!r&&notIgnoredObj(o)&&o.name==e&&(r=o,t&&(_pGlob.objCache[e]=r))}),r)}function getAllObjectNames(){var e=[];return appInstance.scene.traverse(function(r){notIgnoredObj(r)&&e.push(r.name)}),e}function getObjectNamesByGroupName(e){var r=[];return appInstance.scene.traverse(function(t){if(notIgnoredObj(t)){var o=t.groupNames;if(!o)return;for(var n,a=0;a<o.length;a++)n=o[a],n==e&&r.push(t.name)}}),r}function retrieveObjectNames(e){var r=[];return retrieveObjectNamesAcc(e,r),r.filter(function(e){return e})}function retrieveObjectNamesAcc(e,r){if("string"==typeof e)r.push(e);else if(Array.isArray(e)&&"GROUP"==e[0])for(var t=getObjectNamesByGroupName(e[1]),o=0;o<t.length;o++)r.push(t[o]);else if(Array.isArray(e)&&"ALL_OBJECTS"==e[0])for(var t=getAllObjectNames(),o=0;o<t.length;o++)r.push(t[o]);else if(Array.isArray(e))for(var o=0;o<e.length;o++)retrieveObjectNamesAcc(e[o],r)}function initObjectPicking(e,r,t,o){function n(r){if(appInstance.getCamera()){r.preventDefault();var t=0,n=0;if(r instanceof MouseEvent){if(o&&-1==o.indexOf(r.button))return;t=r.offsetX/a.clientWidth,n=r.offsetY/a.clientHeight}else if(r instanceof TouchEvent){var i=a.getBoundingClientRect();t=(r.changedTouches[0].clientX-i.left)/i.width,n=(r.changedTouches[0].clientY-i.top)/i.height}_pGlob.screenCoords.x=2*t-1,_pGlob.screenCoords.y=2*-n+1,d.setFromCamera(_pGlob.screenCoords,appInstance.getCamera(!0));var s=[];appInstance.scene.traverse(function(e){s.push(e)});var l=d.intersectObjects(s);e(l,r)}}var a=appInstance.renderer.domElement;if(a.addEventListener(r,n),v3d.PL.editorEventListeners&&v3d.PL.editorEventListeners.push([a,r,n]),"mousedown"==r){var i=t?"touchstart":"touchend";a.addEventListener(i,n),v3d.PL.editorEventListeners&&v3d.PL.editorEventListeners.push([a,i,n])}else if("dblclick"==r){function e(e){var r=new Date().getTime(),t=r-s;return 600>t&&0<t?(n(e),void(s=0)):void(s=new Date().getTime())}var s=0,i=t?"touchstart":"touchend";a.addEventListener(i,e),v3d.PL.editorEventListeners&&v3d.PL.editorEventListeners.push([a,i,e])}var d=new v3d.Raycaster}function objectsIncludeObj(e,r){if(!r)return!1;for(var t=0;t<e.length;t++){if(r==e[t])return!0;var o=getObjectByName(e[t]);if(o&&"Group"==o.type)for(var n=0;n<o.children.length;n++)if(r==o.children[n].name)return!0}return!1}function getPickedObjectName(e){return e.isMesh&&e.isMaterialGeneratedMesh&&e.parent?e.parent.name:e.name}function registerOnHover(e,r,t,o){_pGlob.objHoverInfo=_pGlob.objHoverInfo||[],_pGlob.objHoverInfo.push({objSelector:e,callbacks:[t,o],xRay:r})}function HOVER_NEXT(){registerOnHover(["black space",LIST_objects],!0,function(){setHTMLElemStyle("cursor","pointer",["CONTAINER"],!1)},function(){setHTMLElemStyle("cursor","default",["CONTAINER"],!1)})}function setWireframeFunction(){return function(objInput,typeVar){function mainFunction(){function arrayCheck(){Array.isArray(objInput)?Array.isArray(objInput)&&objInput.forEach(e=>{meshCheck(e)}):(objArray.push(objInput),objArray.forEach(e=>{meshCheck(e)}))}function meshCheck(objArrayItem){function checkWireframe(obj){if("undefined"!=typeof window.WIN_quadWireframeFunction){function getKeyValue(myKey){let result=eval(`quadWireframe_Objects_Data.${obj.name}.${myKey}`);return result}function setKeyValue(myKey,myValue){let result=eval(`quadWireframe_Objects_Data.${obj.name}.${myKey} = ${myValue}`)}let myProperty=`${obj.name}`;console.log("myProperty:",myProperty),quadWireframe_Objects_Data.hasOwnProperty(myProperty)&&(console.log(obj.name," is in : quadWireframe_Objects_Data"),isWireInput_boolean=getKeyValue("isWireInput"),console.log(obj.name," isWireInput_boolean : ",isWireInput_boolean),setKeyValue("isWireInput","!isWireInput_boolean"),WIN_quadWireframeFunction(obj,!isWireInput_boolean,!0))}else"undefined"==typeof window.WIN_quadWireframeFunction&&alert("[ GLIFTEK ] Plugins - Quad Wireframe Toggle needs a 'Quad Wireframe Shader' plugin used somewhere BEFORE it in the app!")}let objInputObj;objArrayItem instanceof v3d.Mesh?(objInputObj=objArrayItem,checkWireframe(objInputObj)):(objInputObj=app.scene.getObjectByName(objArrayItem),checkWireframe(objInputObj))}let isWireInput_boolean,objArray=[];arrayCheck()}const puzzleName="Quad Wireframe Toggle";objInput?mainFunction():console.log("[ GLIFTEK ]: The","Quad Wireframe Toggle","plugin puzzle is missing an input!")}.apply(null,arguments)}function registerOnClick(e,r,t,o,n,a){_pGlob.objClickInfo=_pGlob.objClickInfo||[],_pGlob.objClickInfo.push({objSelector:e,callbacks:[n,a]}),initObjectPicking(function(t,o){for(var s=!1,d=r?t.length:Math.min(1,t.length),l=0;l<d;l++){var p=t[l].object,u=getPickedObjectName(p),c=retrieveObjectNames(e);objectsIncludeObj(c,u)&&(_pGlob.pickedObject=u,s=!0,n(o))}s||(_pGlob.pickedObject="",a(o))},t?"dblclick":"mousedown",!1,o)}function CHANGE_OBJECT_WIREFRAME(){registerOnClick(LIST_objects,!1,!1,[0,1,2],function(){wireframe_object=LIST_objects[LIST_objects.indexOf(_pGlob.pickedObject)],setWireframeFunction(wireframe_object,"")},function(){})}function disableRendering(e){appInstance.ssaaOnPause=e,appInstance.disableRendering(1)}function enableRendering(){appInstance.enableRendering()}function whenMoved(e,r,t,o,n){function a(e,r,t){if(_pGlob.objMovementInfos[e]){var o=_pGlob.objMovementInfos[e];o.prevPosX=r.position.x,o.prevPosY=r.position.y,o.prevPosZ=r.position.z,o.prevRotX=r.rotation.x,o.prevRotY=r.rotation.y,o.prevRotZ=r.rotation.z,o.prevScaX=r.scale.x,o.prevScaY=r.scale.y,o.prevScaZ=r.scale.z,o.prevIsMoving=t}else{var o={prevPosX:r.position.x,prevPosY:r.position.y,prevPosZ:r.position.z,prevRotX:r.rotation.x,prevRotY:r.rotation.y,prevRotZ:r.rotation.z,prevScaX:r.scale.x,prevScaY:r.scale.y,prevScaZ:r.scale.z,prevIsMoving:t};_pGlob.objMovementInfos[e]=o}return o}function s(e,i,s){var d=_pGlob.objMovementInfos[e]||a(e,i,!1),l=r*s,p=Math.abs(i.position.x-d.prevPosX)>l||Math.abs(i.position.y-d.prevPosY)>l||Math.abs(i.position.z-d.prevPosZ)>l||Math.abs(i.rotation.x-d.prevRotX)>l||Math.abs(i.rotation.y-d.prevRotY)>l||Math.abs(i.rotation.z-d.prevRotZ)>l||Math.abs(i.scale.x-d.prevScaX)>l||Math.abs(i.scale.y-d.prevScaY)>l||Math.abs(i.scale.z-d.prevScaZ)>l;!d.prevIsMoving&&p?(t(e),a(e,i,!0)):d.prevIsMoving&&p?(o(e),a(e,i,!0)):d.prevIsMoving&&!p?(n(e),a(e,i,!1)):a(e,i,!1)}_pGlob.objMovementInfos=_pGlob.objMovementInfos||{},function(e){function r(r){for(var t=retrieveObjectNames(e),o=0;o<t.length;o++){var n=t[o],a=getObjectByName(n);if(!a)return;s(n,a,r)}}appInstance.renderCallbacks.push(r),v3d.PL.editorRenderCallbacks&&v3d.PL.editorRenderCallbacks.push([appInstance,r])}(e)}function eventHTMLElem(e,r,t,o){for(var n,a=getElements(r,t),s=0;s<a.length;s++)n=a[s],n&&(n.addEventListener(e,o),v3d.PL.editorEventListeners&&v3d.PL.editorEventListeners.push([n,e,o]))}function DISABLE_RENDERING(){disableRendering(!1),whenMoved("Camera",.01,function(){enableRendering()},function(){},function(){disableRendering(!1)}),eventHTMLElem("pointerdown",["CONTAINER"],!1,function(){enableRendering()}),eventHTMLElem("pointerup",["CONTAINER"],!1,function(){disableRendering(!1)})}function CHANGE_EXAMPLES(){registerOnClick("black space",!0,!1,[0,1,2],function(){obj_number=LIST_objects.indexOf(current_object),CHANGE_VISIBILITY_OF_ITEMS(obj_number,LIST_objects),CHANGE_VISIBILITY_OF_HELPERS(obj_number,LIST_helpers)},function(){})}function changeVis(e,r){for(var t,o=retrieveObjectNames(e),n=0;n<o.length;n++)if(t=o[n],t){var a=getObjectByName(t);a&&(a.visible=r)}}function CHANGE_VISIBILITY_OF_ITEMS(e,r){changeVis(r[e],!1),list_length=r.length-1,obj_number<list_length?(obj_to_show=r[obj_number+1],SHOW_OBJECTS(),current_object=obj_to_show):obj_number>=list_length&&(obj_to_show=r[0],SHOW_OBJECTS(),current_object=obj_to_show)}function CHANGE_VISIBILITY_OF_HELPERS(e,r){changeVis(r[e],!1),list_length=r.length-1,obj_number<list_length?(obj_to_show=r[obj_number+1],SHOW_OBJECTS()):obj_number>=list_length&&(obj_to_show=r[0],SHOW_OBJECTS())}function SHOW_OBJECTS(){obj_to_show_transparent=obj_to_show+""+"_transparent",console.log("obj_to_show: "+(obj_to_show+"")),changeVis(obj_to_show,!0)}function setScreenScale(e){appInstance.useHiDPIRenderPass||appInstance.renderer.setPixelRatio(e),appInstance.postprocessing&&appInstance.postprocessing.composer.setPixelRatio(e),appInstance.onResize()}function screenFade(){return function(screenFade_ID_Input,screenFade_Z_Index_Input,typeDropdown,screenFade_Pause_Input,screenFade_Duration_Input,colorInput_1_PICKER,colorInput_1_TEXT,delete_When_Done_Checkbox,whenDone_Statement_Input){function mainFunction(){function setColorFromInputs(e,r){let t;return"undefined"==typeof e||null==typeof e||""==e?(t=r,console.log(r,"supplied. using PICKER.")):(t=e,console.log(e,"supplied. using TEXT.")),t}function RGBA_from_color_input(e,r){if("transparent"==e||null==e||"undefined"==typeof e)return"rgba(0, 0, 0, 0)";else{computedColorDiv.style.color=e;let t=window.getComputedStyle(computedColorDiv).color;console.log("computedColor for: ",e,":",t);let o=t.length,n="rgba("+t.substring(4,o-1)+", "+r+")";return console.log("computedColor_RGBA for: ",e,":",n),n}}function getBGcolor(){"in"==typeDropdown?(screenFade_Div.style.backgroundColor="rgba(0,0,0,0)",console.log("screenFade_Div.style.backgroundColor:",screenFade_Div.style.backgroundColor)):"out"==typeDropdown&&(screenFade_Div.style.backgroundColor=screenFadeColor,console.log("screenFade_Div.style.backgroundColor:",screenFade_Div.style.backgroundColor))}function animateScreenFade(){function screenFadeDisplay(){"in"==typeDropdown?(screenFade_Div.style.display="block",console.log("screenFade_Div.style.display:",screenFade_Div.style.display),deleteWhenDone()):"out"==typeDropdown&&(screenFade_Div.style.display="none",console.log("screenFade_Div.style.display:",screenFade_Div.style.display),deleteWhenDone())}function deleteWhenDone(){!0==delete_When_Done_Checkbox&&screenFade_Div.remove()}const animationType="animation-screen-fade-"+typeDropdown+"-"+screenFade_ID_Input;screenFade_Div.style.animationName=animationType,console.log("screenFade_Div.style.animationName:",screenFade_Div.style.animationName),screenFade_Div.addEventListener("animationend",function(event){if(event.animationName==animationType);{screenFade_Div.removeEventListener("animationend",null),screenFadeDisplay();let screenFadeState=eval(`${screenFade_ID_Input}.faded = '${typeDropdown}';`);console.log("screenFadeState:",screenFadeState),whenDone_Statement_Input()}})}function setstyleVar(){return`#computedColorDiv-${screenFade_ID_Input}{height: 0px;width: 0px;display: none;z-index = -10;}.screenFade-${screenFade_ID_Input}{display: block;position: fixed;z-index: ${screenFade_Z_Index_Input};left: 0;top: 0;height: 100%;width: 100%;overflow: hidden;pointer-events: none;animation-duration: ${screenFade_Duration_Input}s;animation-timing-function: ease-in-out;}@keyframes animation-screen-fade-in-${screenFade_ID_Input}{from {background-color: rgba(0,0,0,0);}to {background-color: ${screenFadeColor};}}@keyframes animation-screen-fade-out-${screenFade_ID_Input}{from {background-color: ${screenFadeColor};}to {background-color: rgba(0,0,0,0);}}`}const colorInput_1esc=setColorFromInputs(colorInput_1_TEXT,colorInput_1_PICKER);console.log("colorInput_1esc:",colorInput_1esc);let computedColorDiv=document.createElement("div");computedColorDiv.id="computedColorDiv-"+screenFade_ID_Input,document.body.appendChild(computedColorDiv);const screenFadeColor=RGBA_from_color_input(colorInput_1esc,1);console.log("screenFadeColor: ",screenFadeColor),computedColorDiv.remove();let styleVar=setstyleVar(),style=document.createElement("style");style.id="screenFade-"+screenFade_ID_Input,style.innerHTML=styleVar,document.head.appendChild(style);let screenFade_Div=document.createElement("div");screenFade_Div.id=screenFade_ID_Input,screenFade_Div.className="screenFade-"+screenFade_ID_Input,getBGcolor();const container=document.getElementById("v3d-container");container.appendChild(screenFade_Div),setTimeout(function(){animateScreenFade()},1e3*screenFade_Pause_Input)}const puzzleName="Print To Modal Card";eval(`window.${screenFade_ID_Input} = { faded: null };`),screenFade_ID_Input?mainFunction():console.log("[ GLIFTEK ]: The","Print To Modal Card","plugin puzzle is missing an input!")}.apply(null,arguments)}function FADE_IN_SCREEN(){setScreenScale(1.5),screenFade("screenFade_1",10,"out",1.5,1,"#000000","",!0,function(){DISABLE_RENDERING()})}function MAIN(){EXEC_updateQuadWireframe="window.updateQuadWireframe = true;",_g_list_number=0,obj_number=null,FADE_IN_SCREEN(),MAKE_LISTS(),MAKE_HELPERS(),MAKE_OBJECTS(),HIDE_ALL_OBJECTS(),HOVER_NEXT(),CHANGE_EXAMPLES(),CHANGE_OBJECT_WIREFRAME()}function HIDE_ALL_OBJECTS(){changeVis(["ALL_OBJECTS"],!1),current_object="Teapot",TOGGLE_wireframe_is_see_through=!1,changeVis("Teapot",!0),changeVis("infiniteGridHelper_1",!0),changeVis("black space",!0),changeVis("Text_Next",!0),changeVis("axesHelper_1",!0)}function MAKE_LISTS(){LIST_objects=["Teapot","Torus","Box"],LIST_cube_grid_helpers=["gridHelper_1","gridHelper_2","gridHelper_3","gridHelper_4"],LIST_polar_grid_helpers=["polarGridHelper_1","polarGridHelper_2","polarGridHelper_3","polarGridHelper_4","Cylinder"],LIST_helpers=["infiniteGridHelper_1",LIST_polar_grid_helpers,LIST_cube_grid_helpers]}function MAKE_HELPERS(){MAKE_INFINITE_GRID(),MAKE_GRID_CUBE(),MAKE_GRID_POLAR(),MAKE_OTHER_HELPERS()}function MAKE_OBJECTS(){MAKE_TEAPOT(),MAKE_TORUS(),MAKE_BOX(),SET_MATERIALS()}function createInfiniteGridHelper(){return function(e,r,t,o){(function(){if("undefined"==typeof infiniteGridHelperNumber?window.infiniteGridHelperNumber=1:infiniteGridHelperNumber++,THREE.InfiniteGridHelper=function(e,r,t,o,n="xzy"){t=t||new THREE.Color("white"),e=e||10,r=r||100,o=o||8e3;const a=n.substr(0,2),i=new THREE.PlaneBufferGeometry(2,2,1,1),s=new THREE.ShaderMaterial({side:THREE.DoubleSide,uniforms:{uSize1:{value:e},uSize2:{value:r},uColor:{value:t},uDistance:{value:o}},transparent:!0,vertexShader:`varying vec3 worldPosition;uniform float uDistance;void main() {vec3 pos = position.${n} * uDistance;pos.${a} += cameraPosition.${a};worldPosition = pos;gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);}`,fragmentShader:`varying vec3 worldPosition;uniform float uSize1;uniform float uSize2;uniform vec3 uColor;uniform float uDistance;float getGrid(float size) {vec2 r = worldPosition.${a} / size;vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);float line = min(grid.x, grid.y);return 1.0 - min(line, 1.0);}void main() {float d = 1.0 - min(distance(cameraPosition.${a}, worldPosition.${a}) / uDistance, 1.0);float g1 = getGrid(uSize1);float g2 = getGrid(uSize2);gl_FragColor = vec4(uColor.rgb, mix(g2, g1, g1) * pow(d, 3.0));gl_FragColor.a = mix(0.5 * gl_FragColor.a, gl_FragColor.a, g2);if ( gl_FragColor.a <= 0.0 ) discard;}`,extensions:{derivatives:!0}});THREE.Mesh.call(this,i,s),this.frustumCulled=!1},THREE.InfiniteGridHelper.prototype={...THREE.Mesh.prototype,...THREE.Object3D.prototype,...THREE.EventDispatcher.prototype},126<parseInt(THREE.REVISION)){class e extends THREE.Mesh{constructor(e,r,t,o,n="xzy"){t=t||new THREE.Color("white"),e=e||10,r=r||100,o=o||8e3;const a=n.substr(0,2),i=new THREE.PlaneBufferGeometry(2,2,1,1),s=new THREE.ShaderMaterial({side:THREE.DoubleSide,uniforms:{uSize1:{value:e},uSize2:{value:r},uColor:{value:t},uDistance:{value:o}},transparent:!0,vertexShader:`varying vec3 worldPosition;uniform float uDistance;void main() {vec3 pos = position.${n} * uDistance;pos.${a} += cameraPosition.${a};worldPosition = pos;gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);}`,fragmentShader:`varying vec3 worldPosition;uniform float uSize1;uniform float uSize2;uniform vec3 uColor;uniform float uDistance;float getGrid(float size) {vec2 r = worldPosition.${a} / size;vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);float line = min(grid.x, grid.y);return 1.0 - min(line, 1.0);}void main() {float d = 1.0 - min(distance(cameraPosition.${a}, worldPosition.${a}) / uDistance, 1.0);float g1 = getGrid(uSize1);float g2 = getGrid(uSize2);gl_FragColor = vec4(uColor.rgb, mix(g2, g1, g1) * pow(d, 3.0));gl_FragColor.a = mix(0.5 * gl_FragColor.a, gl_FragColor.a, g2);if ( gl_FragColor.a <= 0.0 ) discard;}`,extensions:{derivatives:!0}});super(i,s),this.frustumCulled=!1}}Object.assign(e.prototype,THREE.InfiniteGridHelper.prototype),THREE.InfiniteGridHelper=e}let n=new THREE.Color(o);(function(){const o=new THREE.InfiniteGridHelper(e,r,n,t);o.name="infiniteGridHelper_"+infiniteGridHelperNumber,app.scene.add(o),o.visible=!0,console.log("infiniteGridHelper:",o)})()})()}.apply(null,arguments)}function MAKE_INFINITE_GRID(){createInfiniteGridHelper(5,50,3e3,"pink")}function createObject(e,r,t,o,n,a,i,s,d,l,p){var u=appInstance.scene.getObjectByName(r);u&&u.parent.remove(u);var c,m;switch(e){case"BOX":m=new v3d.BoxGeometry(t,o,n);break;case"CAMERA":var E=appInstance.container.offsetWidth/appInstance.container.offsetHeight;if("PERSPECTIVE"==d)c=new v3d.PerspectiveCamera(p,E,1,1e3);else{var t=p*E;c=new v3d.OrthographicCamera(-t/2,t/2,p/2,-p/2,-1e3,1e3)}c.lookAt(_pGlob.vec3Tmp.set(0,0,0));break;case"CIRCLE":m=new v3d.CircleGeometry(a,s);break;case"CONE":m=new v3d.ConeGeometry(a,o,s);break;case"CYLINDER":m=new v3d.CylinderGeometry(a,a,o,s);break;case"EMPTY":c=new v3d.Object3D;break;case"LIGHT":var g=16777215,_=.5;"AMBIENT"===l?c=new v3d.AmbientLight(g,_):"AREA"===l?(v3d.RectAreaLightUniformsLib.init(LTC_MAT_1,LTC_MAT_2),c=new v3d.RectAreaLight(g,_,1,1)):"DIRECTIONAL"===l?c=new v3d.DirectionalLight(g,_):"HEMISPHERE"===l?c=new v3d.HemisphereLight(g,0,_):"POINT"===l?c=new v3d.PointLight(g,_):"SPOT"===l?c=new v3d.SpotLight(g,_):void 0;c.isFreeLight=!0;break;case"PLANE":m=new v3d.PlaneGeometry(t,o,1,1);break;case"SPHERE":m=new v3d.SphereGeometry(a,32,32);break;case"TEAPOT":m=new v3d.TeapotGeometry(t);break;case"TORUS":m=new v3d.TorusGeometry(a,i,32,32);}if(m){var y=new v3d.MeshStandardMaterial({color:"white",roughness:1,metalness:0,side:"CIRCLE"==e||"PLANE"==e||"TEAPOT"==e?v3d.DoubleSide:v3d.FrontSide});y.name=r+"Material",c=new v3d.Mesh(m,y)}c.name=r,appInstance.scene.add(c),_pGlob.objCache={}}function getCoordSystem(){var e=appInstance.scene;return e&&"v3d"in e.userData&&"coordSystem"in e.userData.v3d?e.userData.v3d.coordSystem:"Z_UP_RIGHT"}function coordsTransform(e,r,t,o){if(r==t)return e;var n=e.y,a=e.z;return"Z_UP_RIGHT"==r&&"Y_UP_RIGHT"==t?(e.y=a,e.z=o?n:-n):"Y_UP_RIGHT"==r&&"Z_UP_RIGHT"==t?(e.y=o?a:-a,e.z=n):console.error("coordsTransform: Unsupported coordinate space"),e}function RotationInterface(){this._userRotation=new v3d.Euler(0,0,0,"ZYX"),this._actualRotation=new v3d.Euler}function setObjTransform(e,r,t,o){function n(e,t,n){o?"scale"==r?e[r][t]*=n:e[r][t]+=n:e[r][t]=n}var a=t[0],s=t[1],d=t[2],l=retrieveObjectNames(e),p=_pGlob.vec3Tmp.set(+(""!==a),+(""!==s),+(""!==d)),u=_pGlob.vec3Tmp2.set(a||0,s||0,d||0);"rotation"===r&&u.multiplyScalar(v3d.MathUtils.DEG2RAD);var c=getCoordSystem();coordsTransform(p,c,"Y_UP_RIGHT",!0),coordsTransform(u,c,"Y_UP_RIGHT","scale"===r);for(var m,E=0;E<l.length;E++)if(m=l[E],m){var g=getObjectByName(m);if(g){if("rotation"===r&&"Z_UP_RIGHT"==c){var _=eulerV3DToBlenderShortest(g.rotation,_pGlob.eulerTmp);coordsTransform(_,c,"Y_UP_RIGHT"),p.x&&(_.x=o?_.x+u.x:u.x),p.y&&(_.y=o?_.y+u.y:u.y),p.z&&(_.z=o?_.z+u.z:u.z),_.order="YZX",_.reorder(g.rotation.order),g.rotation.copy(_)}else if("rotation"===r&&"Y_UP_RIGHT"==c){var y=RotationInterface.initObject(g),_=y.getUserRotation(_pGlob.eulerTmp);p.x&&(_.x=o?_.x+u.x:u.x),p.y&&(_.y=o?_.y+u.y:u.y),p.z&&(_.z=o?_.z+u.z:u.z),y.setUserRotation(_),y.getActualRotation(g.rotation)}else p.x&&n(g,"x",u.x),p.y&&n(g,"y",u.y),p.z&&n(g,"z",u.z);g.updateMatrixWorld(!0)}}}function MAKE_TEAPOT(){createObject("TEAPOT","Teapot",2,0,0,0,0,0,"PERSPECTIVE","AMBIENT",0),setObjTransform("Teapot","position",["","",5],!1),setObjTransform("Teapot","rotation",["","",90],!1)}function matGetColors(e){var r=v3d.SceneUtils.getMaterialByName(appInstance,e);return r?r.isMeshNodeMaterial?Object.keys(r.nodeRGBMap):r.isMeshStandardMaterial?["color","emissive"]:[]:[]}function setMaterialColor(e,t,o,n,a,s){var d=matGetColors(e);if(!(0>d.indexOf(t))){if(s){var l=new v3d.Color(s);l.convertSRGBToLinear(),o=l.r,n=l.g,a=l.b}for(var p,u=v3d.SceneUtils.getMaterialsByName(appInstance,e),c=0;c<u.length;c++){if(p=u[c],p.isMeshNodeMaterial){var m=p.nodeRGBMap[t];p.nodeRGB[m].x=o,p.nodeRGB[m].y=n,p.nodeRGB[m].z=a}else p[t].r=o,p[t].g=n,p[t].b=a;p.needsUpdate=!0,null!==appInstance.scene&&p===appInstance.scene.worldMaterial&&appInstance.updateEnvironment(p)}}}function setMaterialTransparency(){return function(e,r){e&&"<none>"!=e?function(){app.scene.traverse(function(t){t instanceof v3d.Mesh&&t.material.name==e&&(t.material.opacity=r,t.material.transparent=!0,t.material.needsUpdate=!0)})}():console.log("[ GLIFTEK ]: The","Set Material Transparency","plugin puzzle is missing an input!")}.apply(null,arguments)}function quadWireframeFunction(){return function(objInput,colorInput,segUinput,segVinput,isWireInput,wireWidthInput,wireColorInput){function mainFunction(){function set_quadWireframe_Objects_Data(){let quadWireframeToEval=`quadWireframe_Objects_Data.${objInput} ={objInput: objInput,colorInput: colorInput,segUinput: segUinput,segVinput: segVinput,isWireInput: isWireInput,wireWidthInput: wireWidthInput,wireColorInput: wireColorInput};`;eval(quadWireframeToEval),WIN_quadWireframeFunction(objInputObj,isWireInput,!1)}window.WIN_quadWireframeFunction=function(objForWireframe,isWireInputValue,isForToggle){function getKeyValue(myKey){let result=eval(`quadWireframe_Objects_Data.${objForWireframe.name}.${myKey}`);return result}!1==isForToggle&&(objForWireframe=objInputObj);let uniforms={segU:{value:getKeyValue("segUinput")},segV:{value:getKeyValue("segVinput")},isWire:{value:isWireInputValue},wireWidthFactor:{value:getKeyValue("wireWidthInput")},wireColor:{value:new THREE.Color(getKeyValue("wireColorInput"))}},quadMaterial=new THREE.MeshStandardMaterial({side:THREE.DoubleSide,onBeforeCompile:e=>{e.uniforms.segU=uniforms.segU,e.uniforms.segV=uniforms.segV,e.uniforms.wireColor=uniforms.wireColor,e.uniforms.isWire=uniforms.isWire,e.uniforms.wireWidthFactor=uniforms.wireWidthFactor,e.fragmentShader=`uniform float segU;uniform float segV;uniform vec3 wireColor;uniform float isWire;uniform float wireWidthFactor;
${e.fragmentShader}`.replace(`#include <dithering_fragment>`,`#include <dithering_fragment>
// http://madebyevan.com/shaders/grid/
vec2 coord = vUv * vec2(segU, segV);vec2 grid = abs(fract(coord - 0.5) - 0.5) / fwidth(coord);float line = min(grid.x, grid.y) / wireWidthFactor;line = 1.0 - min(line, 1.0);if (isWire > 0.5 && line < 0.5) discard;if (isWire > 0.5) gl_FragColor = vec4(0);gl_FragColor = mix(gl_FragColor, vec4(wireColor, 1.0), line);`)}});quadMaterial.color=new THREE.Color(colorInput),quadMaterial.defines={USE_UV:""},quadMaterial.opacity=0,objForWireframe.material=quadMaterial,objForWireframe.material.needsUpdate=!0,window.quadMaterialWin=quadMaterial},objInputObj=objInput instanceof v3d.Mesh?objInput:app.scene.getObjectByName(objInput),"undefined"==typeof window.quadWireframe_Objects_Data?(window.quadWireframe_Objects_Data={},set_quadWireframe_Objects_Data()):"undefined"!=typeof window.quadWireframe_Objects_Data&&set_quadWireframe_Objects_Data()}let objInputObj;objInput&&colorInput&&wireColorInput&&segUinput&&segVinput&&wireWidthInput&&wireColorInput?mainFunction():console.log("Quad Material Puzzle missing input!")}.apply(null,arguments)}function SET_MATERIALS(){setMaterialColor("CylinderMaterial","emissive",0,0,0,"cyan"),setMaterialTransparency("CylinderMaterial",.1),COLOR_object_transparent="black",COLOR_object_wireframe="cyan",quadWireframeFunction("Teapot","white",4,4,!1,3,COLOR_object_wireframe),quadWireframeFunction("Torus","black",8,8,!1,3,COLOR_object_wireframe),quadWireframeFunction("Box","black",4,4,!1,3,COLOR_object_wireframe)}function createPolarGridHelper(){return function(e,r,t,o,n,a){(function(){"undefined"==typeof polarGridHelperNumber?window.polarGridHelperNumber=1:polarGridHelperNumber++;let i=new v3d.PolarGridHelper(e,r,t,o,n,a);i.raycast=function(){},i.name="polarGridHelper_"+polarGridHelperNumber,i.up.set(0,0,1),app.scene.add(i)})()}.apply(null,arguments)}function setObjectSelectability(){return function(e,r){e?function(){function t(){if(!Array.isArray(e)){const r=[];r.push(e),r.forEach(o)}else Array.isArray(e)&&(n=e,n.forEach(o))}function o(e){let t;t=e instanceof v3d.Mesh?e:app.scene.getObjectByName(e),window.raycastFunction||(window.raycastFunction=t.raycast);"selectable"==r?t.raycast=window.raycastFunction:"unselectable"==r&&(t.raycast=function(){})}let n;t()}():console.log("[ GLIFTEK ]: The","Set Object Selectability","plugin puzzle is missing an input!")}.apply(null,arguments)}function MAKE_GRID_POLAR(){createPolarGridHelper(5,8,6,64,"gray","gray"),createPolarGridHelper(5,8,6,64,"gray","gray"),setObjTransform("polarGridHelper_2","position",["","",10],!1),createPolarGridHelper(50,8,6,64,"magenta","magenta"),createPolarGridHelper(50,8,6,64,"magenta","magenta"),setObjTransform("polarGridHelper_4","position",["","",10],!1),createObject("CYLINDER","Cylinder",0,10,0,5,0,32,"PERSPECTIVE","AMBIENT",0),setObjectSelectability("Cylinder","unselectable"),setObjTransform("Cylinder","position",["","",5],!1)}function MAKE_TORUS(){createObject("TORUS","Torus",0,0,0,2,1,0,"PERSPECTIVE","AMBIENT",0),setObjTransform("Torus","position",["","",5],!1),setObjTransform("Torus","rotation",[90,"",""],!1)}function MAKE_BOX(){createObject("BOX","Box",4,4,4,0,0,0,"PERSPECTIVE","AMBIENT",0),setObjTransform("Box","position",["","",5],!1)}function createVector(e,r,t){return[e,r,t]}function createArrowHelper(){return function(e,r,t,o){(function(){"undefined"==typeof arrowHelperNumber?window.arrowHelperNumber=1:arrowHelperNumber++;const n=new THREE.Vector3(e[0],e[1],e[2]);n.normalize();const a=new THREE.Vector3(r[0],r[1],r[2]);let i=new v3d.ArrowHelper(n,a,t,o);i.up.set(0,0,1),i.name="arrowHelper_"+arrowHelperNumber,app.scene.add(i)})()}.apply(null,arguments)}function createAxesHelper(){return function(e){(function(){"undefined"==typeof axesHelperNumber?window.axesHelperNumber=1:axesHelperNumber++;let r=new v3d.AxesHelper(e);r.raycast=function(){},r.rotation.set(-1*(Math.PI/2),0,0),r.up.set(0,0,1),r.name="axesHelper_"+axesHelperNumber,app.scene.add(r)})()}.apply(null,arguments)}function MAKE_OTHER_HELPERS(){createArrowHelper(createVector(0,-3,0),createVector(0,0,0),3,"#4682B4",.5,.25),createAxesHelper(3)}function createGridHelper(){return function(e,r,t,o){(function(){"undefined"==typeof gridHelperNumber?window.gridHelperNumber=1:gridHelperNumber++;let n=new v3d.GridHelper(e,r,o,t);n.raycast=function(){},n.up.set(0,0,1),n.name="gridHelper_"+gridHelperNumber,app.scene.add(n)})()}.apply(null,arguments)}function MAKE_GRID_CUBE(){grid_Cube_color="magenta",grid_Cube_Center_color="gray",createGridHelper(10,10,grid_Cube_color,grid_Cube_Center_color),setObjTransform("gridHelper_1","rotation",["",90,""],!1),setObjTransform("gridHelper_1","position",[-5,"",5],!1),createGridHelper(10,10,grid_Cube_color,grid_Cube_Center_color),setObjTransform("gridHelper_2","rotation",["",-90,-90],!1),setObjTransform("gridHelper_2","position",["",5,5],!1),createGridHelper(10,10,grid_Cube_color,grid_Cube_Center_color),createGridHelper(100,20,"purple",grid_Cube_Center_color)}var app=appInstance;initOptions=initOptions||{},"fadeAnnotations"in initOptions&&(_pGlob.fadeAnnotations=initOptions.fadeAnnotations),this.procedures.HOVER_NEXT=HOVER_NEXT,this.procedures.CHANGE_OBJECT_WIREFRAME=CHANGE_OBJECT_WIREFRAME,this.procedures.DISABLE_RENDERING=DISABLE_RENDERING,this.procedures.CHANGE_EXAMPLES=CHANGE_EXAMPLES,this.procedures.CHANGE_VISIBILITY_OF_ITEMS=CHANGE_VISIBILITY_OF_ITEMS,this.procedures.CHANGE_VISIBILITY_OF_HELPERS=CHANGE_VISIBILITY_OF_HELPERS,this.procedures.SHOW_OBJECTS=SHOW_OBJECTS,this.procedures.FADE_IN_SCREEN=FADE_IN_SCREEN,this.procedures.MAIN=MAIN,this.procedures.HIDE_ALL_OBJECTS=HIDE_ALL_OBJECTS,this.procedures.MAKE_LISTS=MAKE_LISTS,this.procedures.MAKE_HELPERS=MAKE_HELPERS,this.procedures.MAKE_OBJECTS=MAKE_OBJECTS,this.procedures.MAKE_INFINITE_GRID=MAKE_INFINITE_GRID,this.procedures.MAKE_TEAPOT=MAKE_TEAPOT,this.procedures.SET_MATERIALS=SET_MATERIALS,this.procedures.MAKE_GRID_POLAR=MAKE_GRID_POLAR,this.procedures.MAKE_TORUS=MAKE_TORUS,this.procedures.MAKE_BOX=MAKE_BOX,this.procedures.MAKE_OTHER_HELPERS=MAKE_OTHER_HELPERS,this.procedures.MAKE_GRID_CUBE=MAKE_GRID_CUBE;var list_number,LIST_to_use,obj_to_show_transparent,EXEC_updateQuadWireframe,LIST_objects,grid_Cube_color,wireframe_object,obj_number,list_length,_g_list_number,current_object,LIST_cube_grid_helpers,grid_Cube_Center_color,obj_to_show,TOGGLE_wireframe_is_see_through,LIST_polar_grid_helpers,COLOR_object_transparent,LIST_helpers,COLOR_object_wireframe,PROC={HOVER_NEXT:HOVER_NEXT,CHANGE_OBJECT_WIREFRAME:CHANGE_OBJECT_WIREFRAME,DISABLE_RENDERING:DISABLE_RENDERING,CHANGE_EXAMPLES:CHANGE_EXAMPLES,CHANGE_VISIBILITY_OF_ITEMS:CHANGE_VISIBILITY_OF_ITEMS,CHANGE_VISIBILITY_OF_HELPERS:CHANGE_VISIBILITY_OF_HELPERS,SHOW_OBJECTS:SHOW_OBJECTS,FADE_IN_SCREEN:FADE_IN_SCREEN,MAIN:MAIN,HIDE_ALL_OBJECTS:HIDE_ALL_OBJECTS,MAKE_LISTS:MAKE_LISTS,MAKE_HELPERS:MAKE_HELPERS,MAKE_OBJECTS:MAKE_OBJECTS,MAKE_INFINITE_GRID:MAKE_INFINITE_GRID,MAKE_TEAPOT:MAKE_TEAPOT,SET_MATERIALS:SET_MATERIALS,MAKE_GRID_POLAR:MAKE_GRID_POLAR,MAKE_TORUS:MAKE_TORUS,MAKE_BOX:MAKE_BOX,MAKE_OTHER_HELPERS:MAKE_OTHER_HELPERS,MAKE_GRID_CUBE:MAKE_GRID_CUBE};initObjectPicking(function(e,r){var t=_pGlob.hoveredObject,o="";_pGlob.objHoverInfo=_pGlob.objHoverInfo||[];var n=1/0;_pGlob.objHoverInfo.forEach(function(r){for(var t=r.xRay?e.length:Math.min(1,e.length),a=0;a<t;a++){var s=e[a].object,d=getPickedObjectName(s);objectsIncludeObj(retrieveObjectNames(r.objSelector),d)&&a<=n&&(o=d,n=a)}});t==o||(_pGlob.objHoverInfo.forEach(function(e){objectsIncludeObj(retrieveObjectNames(e.objSelector),t)&&(_pGlob.hoveredObject=t,e.callbacks[1](r))}),_pGlob.objHoverInfo.forEach(function(e){objectsIncludeObj(retrieveObjectNames(e.objSelector),o)&&(_pGlob.hoveredObject=o,e.callbacks[0](r))}),_pGlob.hoveredObject=o)},"mousemove",!1);var eulerV3DToBlenderShortest=function(){var e=new v3d.Euler,r=new v3d.Euler,t=new v3d.Vector3;return function(o,n){var a=e.copy(o).reorder("YZX"),i=r.copy(a).makeAlternative(),s=a.toVector3(t).lengthSq(),d=i.toVector3(t).lengthSq();return n.copy(s<d?a:i),coordsTransform(n,"Y_UP_RIGHT","Z_UP_RIGHT")}}();Object.assign(RotationInterface,{initObject:function(e){void 0===e.userData.v3d.puzzles&&(e.userData.v3d.puzzles={}),void 0===e.userData.v3d.puzzles.rotationInterface&&(e.userData.v3d.puzzles.rotationInterface=new RotationInterface);var r=e.userData.v3d.puzzles.rotationInterface;return r.updateFromObject(e),r}}),Object.assign(RotationInterface.prototype,{updateFromObject:function(e){this._actualRotation.equalsEps(e.rotation,1e-8)||(this._actualRotation.copy(e.rotation),this._updateUserRotFromActualRot())},getActualRotation:function(e){return e.copy(this._actualRotation)},setUserRotation:function(e){this._userRotation.set(e.x,e.y,e.z),this._updateActualRotFromUserRot()},getUserRotation:function(e){return e.copy(this._userRotation)},_updateUserRotFromActualRot:function(){var e=this._userRotation.order;this._userRotation.copy(this._actualRotation).reorder(e)},_updateActualRotFromUserRot:function(){var e=this._actualRotation.order;this._actualRotation.copy(this._userRotation).reorder(e)}});MAIN()}})();